sudo: false

language: cpp

cache:
  ccache: true

# Build on pull request, or push to:
#  - branches explicitly listed
#  - tags matching regex (vX.Y<anything>)
#    (tags should be vX.Y.dev, vX.Y.0, vX.Y.1, ...)
branches:
  only:
    - 0.2.X
    - 0.3.X
    - /^v\d+\.\w+(\.\w+)?(-\S*)?$/

jobs:
  include:
    - stage: test_it
      os: linux
      dist: trusty
      compiler: gcc
      addons:
        apt:
          packages:
            - bash-completion
            - curl
      install:
        - echo "install on $TRAVIS_OS_NAME"
      script:
        - echo "script on $TRAVIS_OS_NAME"
    - stage: test_it
      os: osx
      compiler: clang
      install:
        - echo "install on $TRAVIS_OS_NAME"
      script:
        - echo "script on $TRAVIS_OS_NAME"
    - stage: package_it
      if: repo IN (prisms-center/CASMcode, bpuchala/CASMcode) AND branch IN (0.3.X_stages) AND type = push
      os: linux
      dist: trusty
      compiler: gcc
      addons:
        apt:
          packages:
            - bash-completion
            - curl
      script: echo "package_it on $TRAVIS_OS_NAME"
    - stage: package_it
      if: repo IN (prisms-center/CASMcode, bpuchala/CASMcode) AND branch IN (0.3.X)
      os: osx
      compiler: clang
      script: echo "package_it on $TRAVIS_OS_NAME"
